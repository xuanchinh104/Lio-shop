<ng-container *ngIf="idModule$ | async">
    <div class="flex flex-row justify-end items-center h-[66px]">
        <div class="flex">
            <button class="btn btn-primary" (click)="addHandler()">
                <i class="icofont-plus mr-[5px]"></i>
                {{ 'BTN.ADD' | transloco }}
            </button>
        </div>
    </div>
    <div class="shadow bg-white rounded overflow-hidden">
        <div class="w-full h-[55px] flex items-center flex-nowrap px-[15px] py-[10px]">
            <ng-container *ngIf="selectionIds && selectionIds.length > 0; else searchTpl">
                <label class="mr-[10px]"
                    ><b>{{ selectionIds.length }}</b> {{ 'LB.SELECTED' | transloco }}
                </label>
                <label class="cursor-pointer text-[#2a7efc] mr-[10px]" (click)="onDeselectedAll()">{{ 'LB.UNSELECTED' | transloco }}</label>
                <button class="btn btn-outline-danger" (click)="removeHandler()">
                    <i class="zmdi zmdi-delete mr-[5px]"></i>
                    {{ 'BTN.DELETE' | transloco }}
                </button>
            </ng-container>
            <ng-template #searchTpl>
                <asc-grid-search [formControl]="searchControl"></asc-grid-search>
            </ng-template>
            <div class="flex ml-auto">
                <button
                    class="h-[35px] mx-[5px] px-3 py-1.5 border border-[#e0e0e0] text-[#848c95] rounded hover:!border-[#296fc9]"
                    (click)="onSyncData()"
                >
                    <i class="icofont-refresh mr-[5px]"></i>
                    {{ 'BTN.SYNC' | transloco }}
                </button>
                <button
                    class="h-[35px] mx-[5px] px-3 py-1.5 border border-[#e0e0e0] text-[#848c95] rounded hover:!border-[#296fc9]"
                    nzTooltipTitle="{{ 'BTN.EXCEL' | transloco }}"
                    nz-tooltip
                >
                    <svg-icon fontSize="19px" key="excel"></svg-icon>
                </button>
            </div>
        </div>
        <div class="grid-wrapper grid-none-border" [ngStyle]="{ 'height.px': pageHeight }">
            <kendo-grid
                [data]="(gridView$ | async)!"
                [loading]="(isLoading$ | async)!"
                [pageSize]="gridState.take!"
                [skip]="gridState.skip!"
                [pageable]="pageConfig"
                [resizable]="true"
                [columnMenu]="false"
                [sortable]="true"
                [selectable]="{ enabled: true, checkboxOnly: true }"
                [navigable]="true"
                kendoGridFocusable
                kendoGridSelectBy="id"
                [selectedKeys]="selectionIds"
                [sort]="gridState.sort!"
                [style.height]="'100%'"
                (dataStateChange)="onStateChange($event)"
            >
                <ng-template kendoGridNoRecordsTemplate>
                    {{ 'LB.NO_DATA' | transloco }}
                </ng-template>
                <kendo-grid-checkbox-column [showSelectAll]="true" [width]="45" [columnMenu]="false"></kendo-grid-checkbox-column>

                <kendo-grid-column
                    [title]="'LB.ACTION' | transloco"
                    [width]="80"
                    [columnMenu]="false"
                    [headerStyle]="{ 'text-align': 'center' }"
                >
                    <ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
                        <div class="text-center">
                            <button nz-dropdown [nzDropdownMenu]="menu">
                                <svg-icon fontSize="24px" key="menu-action"></svg-icon>
                            </button>
                        </div>
                        <nz-dropdown-menu #menu="nzDropdownMenu">
                            <ul nz-menu nzSelectable>
                                <li nz-menu-item class="dropdown-item" (click)="copyHandler(dataItem)">
                                    <i class="zmdi zmdi-copy mr-2"></i>
                                    <a>{{ 'BTN.COPY' | transloco }}</a>
                                </li>
                                <li nz-menu-item class="dropdown-item" (click)="editHandler(dataItem)">
                                    <i class="zmdi zmdi-edit mr-2"></i>
                                    <a>{{ 'BTN.EDIT' | transloco }}</a>
                                </li>
                                <li nz-menu-item class="dropdown-item" (click)="removeHandler(dataItem)">
                                    <i class="zmdi zmdi-delete mr-2"></i>
                                    <a>{{ 'BTN.DELETE' | transloco }}</a>
                                </li>
                            </ul>
                        </nz-dropdown-menu>
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column
                    [title]="'LB.STT' | transloco"
                    [headerStyle]="{ 'text-align': 'center' }"
                    [width]="60"
                    [columnMenu]="false"
                >
                    <ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
                        <div class="text-center">
                            {{ rowIndex + 1 }}
                        </div>
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column field="name" [title]="'MODULE.NHOM_MAN_HINH' | transloco" [width]="250" [columnMenu]="false">
                    <ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
                        <div class="text-link" (click)="editHandler(dataItem)">
                            {{ dataItem.name }}
                        </div>
                    </ng-template>
                </kendo-grid-column>
                <kendo-grid-column
                    field="keyModule"
                    [title]="'MODULE.KEY' | transloco"
                    [width]="150"
                    [columnMenu]="false"
                ></kendo-grid-column>
                <kendo-grid-column
                    field="order"
                    [headerStyle]="{ 'text-align': 'center' }"
                    [style]="{ 'text-align': 'center' }"
                    [title]="'MODULE.THU_TU' | transloco"
                    [columnMenu]="false"
                    [width]="80"
                >
                </kendo-grid-column>
                <kendo-grid-column
                    [title]="'MODULE.MAN_HINH' | transloco"
                    [columnMenu]="false"
                    [headerStyle]="{ 'text-align': 'center' }"
                    [style]="{ 'text-align': 'center' }"
                    [width]="120"
                >
                    <ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
                        <div class="text-center">
                            <span (click)="showListScreen(dataItem)" class="cursor-pointer text-blue-500 hover:underline">
                                Xem [{{ dataItem.totalFunction }}]
                            </span>
                        </div>
                    </ng-template>
                </kendo-grid-column>
            </kendo-grid>
        </div>
    </div>
    <div *ngIf="error$ | async"></div>
</ng-container>
